"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _lodash = _interopRequireDefault(require("lodash"));

var _Text = _interopRequireDefault(require("../helper/Text"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var _default = function _default(markdown, error) {
  var ast = error.ast;
  var _ast$node = ast.node,
      position = _ast$node.position,
      type = _ast$node.type;
  var start = position.start,
      end = position.end;
  var text = new _Text["default"](markdown);
  var md = '';

  if (type === 'image') {
    var alt = ast.node.alt;
    md = "![".concat(alt, "](.)");
  } else {
    // type === 'link'
    var title = _lodash["default"].get(ast.node, 'children[0].value', '');

    md = "[".concat(title, "](.)");
  } // 删除原来的块


  text.removeBlock(start, end); // 添加新的 markdown 片段

  text.insertBlock(start.line, start.column, md);
  return text.result();
};

exports["default"] = _default;